<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:replace="fragments/layout.html :: head('수거요청')">>
    <meta charset="UTF-8">
    <title th:text="${title}">수거요청</title>
</head>
<body th:align="center">
<nav class="py-2 bg-light border-bottom"  th:replace="/fragments/layout.html :: menu">
</nav>
<header class="py-3 mb-4 border-bottom" th:replace="/fragments/layout.html :: header">
</header>
<div class="p-3 mb-2 bg-light rounded-1">
    <div class="d-flex justify-content-center">
        <h3  class="fw-bold">수거요청</h3>
    </div>
</div>
<div class="container">
<table class="table">
    <tr>
        <td th:text="제목" ></td>
        <td th:text="${board.title}"></td>
    </tr>
    <tr>
        <td th:text="작성자"></td>
        <td th:text="${board.writeName}"></td>
    </tr>
    <tr>
        <td th:text="내용"></td>
        <td th:text="${board.contents}" cols="150" row="10"></td>
    </tr>
    <tr>
        <td th:text="작성일"></td>
        <td th:text="${board.writeDate}"></td>
    </tr>
    <tr>
        <td th:text="조회수"></td>
        <td th:text="${board.cnt}"></td>
    </tr>
</table>
</div>
<div class="d-flex justify-content-md-center">
    <a th:href="@{${board.filepath}}">다운받기</a>
        <button class="btn btn-warning modify">수정</button>
        <button class="btn btn-info remove">삭제</button>
</div>
<div id = "comment-write" class="d-flex justify-content-center">
<!--    <input type="text" id="commentWriter" placeholder="작성자">-->
    작성자 <span id="commentWriter" sec:authentication="principal.username"></span>
    <input type="text" id="comment" placeholder="댓글내용">
    <button id="comment-write-btn" onclick="commentWrite()">댓글작성</button>
</div>
<div id="comment-list">

</div>
<br>
<div class="d-flex justify-content-center">
<a th:href="@{list}">글 목록 보기</a>
</div>
<footer class="container" th:fragment="foot">
    <p class="float-end"><a href="#">Back to top</a></p>
    <p>&copy; 2017–2023 Company, Inc. &middot; <a href="#">Privacy</a> &middot; <a href="#">Terms</a></p>
</footer>
</body>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>
<script th:inline="javascript">
    const commentWrite = () => {
        const writer = document.getElementById("commentWriter").value;
        const comment = document.getElementById("comment").value;
        console.log("작성자:", writer);
        console.log("댓글내용:", comment);
        const boardNo = [[${board.boardNo}]];
        $.ajax({
            type: "post",
            url: "/comment/save",
            data: {
                "commentWriter" : writer,
                "comment" : comment,
                "boardNo" : boardNo
            },
            success: function (res) {
                console.log("요청 성공", res);
            },
            error: function (err) {
                console.log("요청 실패", err);
            }
        });
    }
</script>
</html>